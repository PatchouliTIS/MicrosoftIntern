# Copyright (c) 2024 Microsoft
# Licensed under The MIT License [see LICENSE for details]


import os 
os.environ['CUDA_VISIBLE_DEVICES'] = '1'
from vllm import LLM, SamplingParams

import time
from tokenize_fast import FastTokenizer
from inference import FastInference
from minference import MInference
import args

# prompts = [
#     "Hello, my name is",
#     "The president of the United States is",
#     "The capital of France is",
#     "The future of AI is",
#     "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"massageViper\" expecting results in language \"en\".Mumbai,Maharashtra\n\n#Bing search results for \"massageViper\"\nPosition:1\r\nUrl:https://massageviper.com/all-videos/\r\nTitle:All Videos - massageviper.com\r\nSnippet:Videos FeaturedVideos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] RecentVideos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] All Videos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] Testim\r\nPosition:2\r\nUrl:https://articleshubspot.com/massageviper-leak-review/\r\nTitle:MassageViper Leak: A Comprehensive Review - Articles Hubspot\r\nSnippet:Overall, MassageViper is a good option for massage therapists who are looking for a way to connect with potential clients and manage their businesses. It is easy to use, has a large user base, and offers a number of features specifically designed for massage therapists. Massageviper Video\r\nPosition:3\r\nUrl:https://massageviper.com/about/\r\nTitle:About - massageviper.com\r\nSnippet:Massageviper.com is a website that offers online courses in various cooking skills, such as lorem ipsum, cillum, and more. You can enroll today and start learning new cooking skills with the best possible help.\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"massageViper\".Mumbai,Maharashtra Please provide a list of intents.\n ASSISTANT:"
# ]

prompts = [
    "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"massageViper\" expecting results in language \"en\".Mumbai,Maharashtra\n\n#Bing search results for \"massageViper\"\nPosition:1\r\nUrl:https://massageviper.com/all-videos/\r\nTitle:All Videos - massageviper.com\r\nSnippet:Videos FeaturedVideos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] RecentVideos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] All Videos Lorem ipsum dolor sit amet, adipiscing elit ut elit. [ld_course_list] Testim\r\nPosition:2\r\nUrl:https://articleshubspot.com/massageviper-leak-review/\r\nTitle:MassageViper Leak: A Comprehensive Review - Articles Hubspot\r\nSnippet:Overall, MassageViper is a good option for massage therapists who are looking for a way to connect with potential clients and manage their businesses. It is easy to use, has a large user base, and offers a number of features specifically designed for massage therapists. Massageviper Video\r\nPosition:3\r\nUrl:https://massageviper.com/about/\r\nTitle:About - massageviper.com\r\nSnippet:Massageviper.com is a website that offers online courses in various cooking skills, such as lorem ipsum, cillum, and more. You can enroll today and start learning new cooking skills with the best possible help.\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"massageViper\".Mumbai,Maharashtra Please provide a list of intents.\n ASSISTANT:",
    "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"ryobi tools 18v tools\" expecting results in language \"en\".Garland,Texas\n\n#Bing search results for \"ryobi tools 18v tools\"\nPosition:1\r\nUrl:https://www.ryobitools.com/products/one-plus\r\nTitle:RYOBI ONE+ - RYOBI Tools\r\nSnippet:The RYOBI 18V ONE+ System features over 300 innovative products, giving you ultimate versatility and selection to get the job done. With advanced lithium technology, RYOBI powers through drilling, cutting, fastening, lighting, plumbing, or cooling on your projects or trimming, edging, mowing or clearing in the yard, ONE+ gives power to do more.\r\nPosition:2\r\nUrl:https://www.ryobitools.com/products/details/3328719508\r\nTitle:18V ONE+ MULTI-TOOL - RYOBI Tools\r\nSnippet:Expand your RYOBI 18V ONE+ System with the new and improved 18V ONE+ Cordless Multi-Tool. With increased power and up to 20,000 max OPM (Oscillations Per Minute) you can take on the most demanding applications. This Multi-Tool features the lowest vibration in it's class, helping to reduce user fatigue and ensure precise accuracy.\r\nPosition:3\r\nUrl:https://www.ryobitools.com/products/details/33287200153\r\nTitle:18V ONE+ 6-TOOL COMBO KIT - RYOBI Tools\r\nSnippet:RYOBI introduces the 18V ONE+ 6-Tool Combo Kit with 1/2\" Drill/Driver, 1/4\" Impact Driver, Reciprocating Saw, 5-1/2\" Circular Saw, Multi-Tool, LED Light, (1) 1.5Ah Lithium-ion Battery, (1) 4Ah Lithium-ion Battery, 18V Charg\r\nPosition:4\r\nUrl:https://www.amazon.com/ryobi-18-volt-tools/s?k=ryobi+18+volt+tools\r\nTitle:Amazon.com: Ryobi 18 Volt Tools\r\nSnippet:1-48 of over 5,000 results for \"ryobi 18 volt tools\" Results Price and other details may vary based on product size and color. Ryobi 18V Multi Tool 522 1K+ bought in past month $5595 List: $79.00 FREE delivery Mon, Jan 8 More Buying Choices $44.99 (42 used & new offers) Ryobi\r\nPosition:5\r\nUrl:https://www.amazon.com/RYOBI-Brushless-Cordless-Circular-PBLCS300B/dp/B099CHFN88\r\nTitle:RYOBI ONE+ HP 18V Brushless Cordless 7-1/4 in. Circular Saw (Tool Only ...\r\nSnippet:The RYOBI 18V ONE+ HP Brushless line of products is redefining power and performance. The RYOBI 18V ONE+ HP Brushless 7-1/4 in. Circular Saw features a brushless motor delivers, which 40% faster cutting and over 325 cuts per charge, to outperform your previous tools. The die cast upper guard provides greater durability in any work environment.\r\nPosition:6\r\nUrl:https://www.amazon.com/ryobi-18v-tools/s?k=ryobi+18v+tools\r\nTitle:Amazon.com: Ryobi 18v Tools\r\nSnippet:1-48 of over 10,000 results for \"ryobi 18v tools\" Results Price and other details may vary based on product size and color. Overall Pick RYOBI PCL660B ONE+ 18V Cordless LED Flash Light (Tool Only) 562 1K+ bought in past month $1870 FREE delivery Tue, Oct 31 on $35 of items shipped\r\nPosition:7\r\nUrl:https://www.ryobitools.com/products/details/33287186235\r\nTitle:18V ONE+ 2-Tool KIT - RYOBI Tools\r\nSnippet:The RYOBI 18V ONE+ System features over 300 innovative products, giving you ultimate versatility and selection to get the job done. With advanced lithium technology, RYOBI powers through drilling, cutting, fastening, lighting, plumbing, or cooling on your projects or trimming, edging, mowing or clearing in the yard.\r\nPosition:8\r\nUrl:https://slickdeals.net/f/17295853-ryobi-one-18v-cordless-corner-cat-finish-sander-tool-only-w-9-piece-5-1-2-sand-paper-assortment-23-26-w-hack\r\nTitle:RYOBI ONE+ 18V Cordless Corner Cat Finish Sander (Tool ... - Slickdeals\r\nSnippet:RYOBI introduces the 18V ONE+ Cordless Corner Cat Finish Sander (Tool Only) with 9-Piece 5-1/2 in. Corner Cat Sand Paper Assortment. The compact size, triangular base, and 50% reduced vibration vs the previous model provides more control for an even finer finish.\r\nPosition:9\r\nUrl:https://www.amazon.com/ryobi-tools-18v-power/s?k=ryobi+tools+18v+power+tools\r\nTitle:Amazon.com: Ryobi Tools 18v Power Tools\r\nSnippet:Amazon.com: Ryobi Tools 18v Power Tools 1-48 of over 3,000 results for \"ryobi tools 18v power tools\" Results RYOBI ONE+ HP 18V Brushless Cordless 4-1/2 in. Angle Grinder (Tool Only) PBLAG01B 57 400+ bought in past month $7801 Typical: $\r\nPosition:10\r\nUrl:https://offerup.com/item/detail/1664018157\r\nTitle:Ryobi ONE+ 18V 3 Tool Combo Kit Drill Circular Saw Recip Saw ... - OfferUp\r\nSnippet:New, RYOBI introduces the 18V ONE+ Lithium-Ion Cordless Combo Kit (3-Tool) with (1) 1.5 Ah Battery, and Charger. The Drill/Driver has a 1/2 in. heavy duty single sleeve keyless chuck with 24-position clutch to match your drilling and driving needs. The Circular Saw has front pommel handle for 2-handed operation\r\nPosition:11\r\nUrl:https://www.msn.com/en-us/money/other/5-ryobi-tools-that-could-help-you-save-money-on-home-repairs/ar-AA1kpvm0\r\nTitle:5 Ryobi Tools That Could Help You Save Money On Home Repairs - MSN\r\nSnippet:The Ryobi 18V One+ Multi-Tool is an excellent option as it is a device for both oscillation cutting and sanding. It can oscillate between 10,000-20,000 a minute using a 4.0Ah battery with the rate ...\r\nPosition:12\r\nUrl:https://www.msn.com/en-us/autos/buying/the-best-ryobi-power-tools-to-use-on-your-car/ar-AA1gDmxn\r\nTitle:The Best Ryobi Power Tools To Use On Your Car - MSN\r\nSnippet:Like many Ryobi power tools, the 18V ONE+ HP Brushless 3/8\" Extended Reach Ratchet will feel at home in the tool collection of both professionals and more casual DIY-ers.Its slim design, four ...\r\nPosition:13\r\nUrl:https://www.ryobitools.com/products/details/33287191826\r\nTitle:18V CUT-OUT TOOL - RYOBI Tools\r\nSnippet:Specifications Support Accessories Reviews Features Motor provides up to 28,000 RPM For fast cutting Speed Over 190 cuts per charge Enhanced Cut Visibility With LED worklight Quick and Easy Bit Changes With on-board wrench storage Tool-Free Depth Adjustments For greater cutting control\r\nPosition:14\r\nUrl:https://www.5miles.com/item/3zMKrOdmj6nPvmGy/ryobi-introduces-the-18v-one+-lithiumion-cordless-combo-kit-%283tool%29-with-%281%29-15-ah-battery-and-charger-the-drilldriver-has-a-12-in-heavy-duty-single-sleeve-keyless-chuck-with-24position-clutch-to-match-your-drilling-and-driving-needs-the-circular-saw-has-front-pommel-handle-for-2handed-operation-and-a-left-side-blade-for-better-cutline-visibility-the-reciprocating-saw-includes-a-variable-speed-trigger-to-provide-more-control-while-cutting-a-variety-of-materials-best-of-all-this-co\r\nTitle:RYOBI introduces the 18V ONE+ Lithium-Ion Cordless Combo Kit (3-Tool ...\r\nSnippet:RYOBI introduces the 18V ONE+ Lithium-Ion Cordless Combo Kit (3-Tool) with (1) 1.5 Ah Battery, and Charger. The Drill/Driver has a 1/2 in. heavy duty single sleeve keyless chuck with 24-position clutch to match your drilling and driving needs. The Circular Saw has front pommel handle for 2-handed operation and a\r\nPosition:15\r\nUrl:https://www.msn.com/en-us/lifestyle/shopping/3-ryobi-tools-to-help-make-yard-work-a-breeze/ar-AA1lX4Z4\r\nTitle:3 Ryobi Tools To Help Make Yard Work A Breeze - MSN\r\nSnippet:RYOBI P21012BTLVNM ONE+ HP 18V Brushless 110 MPH 350 CFM Cordless Variable-Speed Jet Fan Leaf Blower (Tool Only) RYOBI 40-Volt 18 in. 2-In-1 Cordless Battery Walk Behind Push Lawn Mower With. 40V ...\r\nPosition:16\r\nUrl:https://www.amazon.com/18v-ryobi-tools/s?k=18v+ryobi+tools\r\nTitle:Amazon.com: 18v Ryobi Tools\r\nSnippet:$2877 Get it as soon as Wed, Sep 21 FREE Shipping by Amazon RYOBI PBLMT50B ONE+ HP 18-Volt Brushless Cordless Multi-Tool (Tool Only) 72 $9189 Get it as soon as Wed, Sep 21 FREE Shipping by Amazon More Buying Choices $50.00 (17 used & new offers) Ryobi P2\r\nPosition:17\r\nUrl:https://www.ryobitools.com/products/details/33287177295\r\nTitle:18V ONE+ ROTARY TOOL STATION - RYOBI Tools\r\nSnippet:Products all work with any RYOBI 18V One+ Battery 18V ONE+ ROTARY TOOL STATION P460 33 accessories included for a variety of applications 33 Accessories Included for a Variety of Applications Variable speed up to 34,000 RPM RYOBI introduces the 18V ONE+ Lithium-Ion Cordless Rotary Tool.\r\nPosition:18\r\nUrl:https://www.msn.com/en-us/lifestyle/shopping/5-ryobi-tools-that-are-no-brainers-at-their-price/ar-AA1fyxr5\r\nTitle:5 Ryobi Tools That Are No-Brainers At Their Price - MSN\r\nSnippet:The 12V cordless rotary tool and the 18V rotary tool (with the base) are both available for $99 as of this writing. ONE+ 18V Cordless 1 Gal. Wet/Dry Vacuum The most important part of any job is ...\r\nPosition:19\r\nUrl:https://www.amazon.com/ryobi-tools-18v/s?k=ryobi+tools+18v\r\nTitle:Amazon.com: Ryobi Tools 18v\r\nSnippet:1-48 of over 4,000 results for \"ryobi tools 18v\" Results Price and other details may vary based on product size and color. RYOBI 18-Volt ONE+ Cordless High Volume Power Inflator (Tool Only) P738 (Bulk Packaged, Non-Retail Packaging), Battery Powered 1,248 600+ bought in past month $\r\nPosition:20\r\nUrl:https://www.ryobitools.com/products/details/33287218493\r\nTitle:18V ONE+ HP HIGH-CAPACITY STICK VACUUM KIT - RYOBI Tools\r\nSnippet:Over 300 ONE+ Products – All Work With Any RYOBI 18V ONE+ Battery. The RYOBI 18V ONE+ HP High-Capacity Stick Vacuum Kit is designed for your convenience and maneuverability, weighing only 3 lbs. when in use, making it RYOBI’s lightest weight in hand stick vacuum. This vacuum is Pet Rated, equipped with a WrapDef\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"ryobi tools 18v tools\".Garland,Texas Please provide a list of intents.\n ASSISTANT:",
    "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"tadawul\" expecting results in language \"ar\".Al Arid Dist,Riyadh\n\n#Bing search results for \"tadawul\"\nPosition:1\r\nUrl:https://www.saudiexchange.sa/wps/portal/saudiexchange/ourmarkets/main-market-watch?locale=ar\r\nTitle:السوق الرئيسية - Saudi Stock Exchange (Tadawul)\r\nSnippet:السوق الرئيسية. جميع أسهم السوق الرئيسية. ملخص السوق. أداء السوق. مؤشرات السوق. الأسعار الافتراضية. معلومات التداول للمصد\r\nPosition:2\r\nUrl:http://tadawul.com.sa/\r\nTitle:Tadawul\r\nSnippet:tadawul group 221.20 7.40 (3.46%) | amlak 14.30 0.22 (1.56%) | shl 17.00-0.06 (-0.35%) | saic 30.85 | nayifat 14.46 0.12 (0.84%) | mrna\r\nPosition:3\r\nUrl:https://www.saudiexchange.sa/wps/portal/tadawul/home/\r\nTitle:Market Summary Home V2 - Saudi Stock Exchange (Tadawul)\r\nSnippet:About Saudi Exchange. Saudi Capital Market Awards. IPO of The Year 2023 (Noum and MM) - Direct Listing of The Year 2023 - Nomu. Debt Capital Markets House of The Year 2023. Equity Capital Markets House of The Year 2023. Merger and Acquisition M&A of The Year 2023. Private Placement of The Year 2\r\nPosition:4\r\nUrl:https://www.saudiexchange.sa/wps/portal/saudiexchange/ourmarkets/main-market-watch\r\nTitle:Main Market - Saudi Stock Exchange (Tadawul)\r\nSnippet:tadawul group 225.60 3.80 (1.71%) | amlak 14.28-0.06 (-0.42%) | shl 16.84-0.14 (-0.82%) | saic 30.95 0.10 (0.32%) | nayifat 14.30-0.1\r\nPosition:5\r\nUrl:https://tadawul.com.sa/wps/portal\r\nTitle:Market Summary Home V2 - Tadawul\r\nSnippet:Saudi Capital Market Forum is a platform for investors and market participants to access information and insights on the Saudi capital market. The home page shows the latest market summary, news, events and analysis for the main market, parallel market, Sukuk and Bonds, and funds sectors.\r\nPosition:6\r\nUrl:https://cdn.saudiexchange.sa/wps/portal/saudiexchange/ourmarkets/main-market-watch?locale=ar\r\nTitle:السوق الرئيسية\r\nSnippet:الرئيسية السوق مفتوح - تنفيذ المشتقات السوق مفتوح - تنفيذ نمو حد أعلى السوق مفتوح - تنفيذ الصكوك و السندات السوق مفتوح - ت\r\nPosition:7\r\nUrl:https://tadawul.com.sa/wps/portal/tadawul/home?locale=ar\r\nTitle:Market Summary Home V2 - tadawul.com.sa\r\nSnippet:tadawul group 216.60-1.40 (-0.64%) | amlak 14.48-0.04 (-0.28%) | shl 17.20-0.30 (-1.71%) | saic 31.60 0.30 (0.96%) | nayifat 14.42 0.0\r\nPosition:8\r\nUrl:https://tadawulgroup.sa/wps/portal/tadawulgroup/portfolio/saudi-exchange\r\nTitle:SAUDI EXCHANGE - Tadawul Group\r\nSnippet:Saudi Exchange is the official source of market information and the largest and most liquid stock market in the Middle East, offering listing and trading in securities for local and international investors. Learn about its service offering, market in numbers, market participants, and leadership from Tadawul Group, the parent company of Saudi Exchange.\r\nPosition:9\r\nUrl:https://tadawulgroup.sa/wps/portal/tadawulgroup/portfolio/saudi-exchange?locale=ar\r\nTitle:تداول السعودية - Tadawul Group\r\nSnippet:للتداول في أسواق تداول السعودية، يجب على المستثمرين أولاً التواصل مع أحد أعضاء السوق لفتح محفظة استثمارية. ي\r\nPosition:10\r\nUrl:https://tadawulgroup.sa/wps/portal/tadawulgroup/home?locale=ar\r\nTitle:الصفحة الرئيسية - Tadawul Group\r\nSnippet:هذه الصفحة هي موقع إلكتروني يقدم جوائز السوق المالية للمملكة العربية السعودية باللغة العربية والإنجليزية. يمكنك مشا\r\nPosition:11\r\nUrl:https://www.alrajhitadawul.com.sa/RcmClientWeb/customerHomeAction.do?reqCode=GBS\r\nTitle:الراجحي المالية - تداول الأنترنت\r\nSnippet:لتحديث رقم الجوال يمكنكم زيارة أحد مراكزنا الإستثمارية أو الإتصال بخدمة العملاء على 00966920005856. يمكنك الاطل\r\nPosition:12\r\nUrl:https://www.alahlitadawul.com/\r\nTitle:تسجيل دخول العميل - الأهلي تداول\r\nSnippet:عزيزي العميل ، أمن المعلومات الخاص بك هو الشاغل الرئيسي لكابيتال snb. لذلك كن على ثقة حول سرية عملياتك بما انه\r\nPosition:13\r\nUrl:https://annualreport2018.tadawul.com.sa/Resources/AnnualReport/ar/index.html\r\nTitle:السوق المالية السعودية - Tadawul\r\nSnippet:مهدت الخطوات المدروسة التي اتخذناها سابقاً الطريق للإنجازات التي حققناها في عام 2018م. %8.3 ارتفع مؤشر تاسي بنس\r\nPosition:14\r\nUrl:https://www.alrajhitadawul.com.sa/RcmClientWeb/startOnlineAccountOpeningAction.do\r\nTitle:الراجحي المالية - تداول الأنترنت\r\nSnippet:تأكد من توفر بطاقة الصراف الآلي لمصرف الراجحي سارية المفعول. قم بالضغط على أيقونة \"لنبدأ\". قم بإدخال رقم بطاقة ال\r\nPosition:15\r\nUrl:https://invest.sfc.sa/\r\nTitle:SFC Trade\r\nSnippet:SFC Trade. مرحبا. لتسجيل الدخول .. يرجى أدخال البيانات المطلوبة. لا يوجد لديكم حساب استثماري ؟. فتح حساب استثماري ج\r\nPosition:16\r\nUrl:https://annualreport2019.tadawul.com.sa/Resources/AnnualReport2019/company_profile/about_tadawul.html\r\nTitle:Saudi Stock Exchange\r\nSnippet:Tadawul provides a platform for the listing and trading of a variety of securities such as equities, Real Estate Investment Traded Funds (REITs), Exchange Traded Funds (ETFs), Corporate bonds, Government bonds, and Sukuks.\r\nPosition:17\r\nUrl:https://tadawulgroup.sa/\r\nTitle:Tadawul Group\r\nSnippet:Saudi Tadawul Group signs MoU with SIX Group as part of the Saudi Swiss dialogue. Read Story. Financial Results for the Period Ending on 2022-03-31 ( Three Months ) Read Story. Financial Results for the Period Ending on 2022-06-30 ( Six Months ) Read Story. View All.\r\nPosition:18\r\nUrl:https://www.alinmatadawul.com/alinmaTadawul/pages/TradeStation.jsf\r\nTitle:Alinma Tadawul\r\nSnippet:Alinma Tadawul is a platform that allows you to trade stocks and securities in the Saudi market with convenience and security. You can access your investment account online, view market data and analysis, and benefit from various features and services. Join Alinma Tadawul today and start investing smartly.\r\nPosition:19\r\nUrl:https://www.alinmatadawul.com/alinmaTadawul/public/login.jsf?session_locale=ar\r\nTitle:تداول الإنماء - Alinma Tadawul\r\nSnippet:تعرف على مزايا تداول الإنماء. بيع وشراء الأسهم بشكل فوري. إلغاء وتعديل الأوامر المعلقة. يقدم الصورة الكاملة للم\r\nPosition:20\r\nUrl:https://www.alinmatadawul.com/alinmaTadawul/pages/home.jsf\r\nTitle:Alinma Tadawul\r\nSnippet:Alinma Tadawul is the online trading platform of Alinma Investment, a leading financial institution in Saudi Arabia. With Alinma Tadawul, you can access the Saudi stock market, manage your portfolio, and execute your orders with convenience and security. You can also open an investment account easily using your Alinma Bank account number. Join Alinma Tadawul today and enjoy the benefits of ...\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"tadawul\".Al Arid Dist,Riyadh Please provide a list of intents.\n ASSISTANT:",
    "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"tips and advice for investing in young corporation.\" expecting results in language \"en\".Kansas City,Missouri\n\n#Bing search results for \"tips and advice for investing in young corporation.\"\nPosition:1\r\nUrl:https://www.thebalancemoney.com/tips-young-investors-should-follow-4126055\r\nTitle:Simple Advice for Young Investors - The Balance\r\nSnippet:Key Takeaways With the power of compound interest, you can grow your money exponentially. Set specific financial goals and have a set time period so you can make better investing decisions. Consider making consistent contributions to a diversified tax-advantaged retirement account.\r\nPosition:2\r\nUrl:https://money.usnews.com/investing/articles/investing-for-teens-how-to-invest-money-as-a-teenager\r\nTitle:Investing for Teens: How to Invest Money as a Teenager\r\nSnippet:Here are some tips on investing for teens: Review brokerage account options for teens. Avoid crypto, stick with stocks. Do research to mitigate mistakes. Set obtainable goals. Tap into...\r\nPosition:3\r\nUrl:https://www.investopedia.com/investing-for-teens-7111843\r\nTitle:Investing for Teens: What They Should Know - Investopedia\r\nSnippet:Fact checked by. Vikki Velasquez. There are many reasons why teens and those who may have not yet reached the age of legal adult adulthood should invest. The most significant advantage is the time ...\r\nPosition:4\r\nUrl:https://www.kiplinger.com/investing/stock-trading-tips-for-teens-new-to-investing\r\nTitle:Seven Stock Trading Tips for Teens New to Investing | Kiplinger\r\nSnippet:Investing in stocks can be a great way for teenagers to gauge their interest in the markets and to achieve their financial goals. Teens can build long-term wealth, save for specific goals and ...\r\nPosition:5\r\nUrl:https://investinganswers.com/articles/ask-expert-whats-best-way-start-investing-when-youre-young\r\nTitle:The Best Way to Start Investing at a Young Age\r\nSnippet:Where to Start Investing Young. When you're young, you generally want higher returns that stocks, stock-based mutual funds, or ETFs can provide – rather than slower-growing investments like bonds and CDs. Yes, there is inherently more risk in these types of investments, but remember: You’re investing with a long-term mindset.\r\nPosition:6\r\nUrl:https://www.fidelity.com/learning-center/personal-finance/young-investors\r\nTitle:Bear market guide for young investors | Financial planning | Fidelity\r\nSnippet:Young investors should make the most of this bear market and the opportunities afforded by the recently passed CARES Act. Here are 5 smart strategies for young investors.\r\nPosition:7\r\nUrl:https://www.investopedia.com/articles/younginvestors/12/portfolio-management-tips-young-investors.asp\r\nTitle:Portfolio Management Tips for Young Investors\r\nSnippet:Key Takeaways Portfolio management involves investing in a variety of assets, such as stocks, bonds, and real estate, to reduce risk and maximize returns. To start managing a portfolio, it's...\r\nPosition:8\r\nUrl:https://www.cnbc.com/2022/03/14/just-getting-started-in-investing-here-are-5-tips-for-young-investors.html\r\nTitle:Just getting started in investing? Here are 5 tips for young investors\r\nSnippet:Here are 5 tips for young investors Published Mon, Mar 14 20229:00 AM EDT Andrew Osterland Key Points Millennials are famously wary of the financial markets, thanks to experiences like the...\r\nPosition:9\r\nUrl:https://www.nytimes.com/2020/02/10/smarter-living/the-young-persons-guide-to-investing.html\r\nTitle:The Young Person’s Guide to Investing - The New York Times\r\nSnippet:The Young Person’s Guide to Investing Narrowing down all the options and figuring out where to turn can be paralyzing. We’ve got you covered. Jocelyn Tsaih By Tara Siegel Bernard Published Feb....\r\nPosition:10\r\nUrl:https://fortune.com/2021/10/14/investing-advice-investment-tips-for-young-investors-beginners/\r\nTitle:4 timeless investment tips for young investors | Fortune\r\nSnippet:Young people regularly contributing money into the stock market should hope and pray for regular downturns. That’s how you buy in at lower valuations, higher dividend yields, and better price ...\r\nPosition:11\r\nUrl:https://www.forbes.com/sites/forbescoachescouncil/2022/02/18/advice-for-young-people-who-want-to-own-a-business/\r\nTitle:Advice For Young People Who Want To Own A Business - Forbes\r\nSnippet:There are many words of wisdom for young people starting their careers. Walt Disney said, “All our dreams can come true — if we have the courage to pursue them.” I wholeheartedly agree. But it...\r\nPosition:12\r\nUrl:https://www.forbes.com/sites/forbesfinancecouncil/2018/12/28/stock-success-15-tips-for-young-adults-dipping-into-investing/\r\nTitle:Stock Success: 15 Tips For Young Adults Dipping Into Investing - Forbes\r\nSnippet:1. Educate Yourself First Get to know the basics of the stock market before jumping in. Financial metrics, stock selection and different investment accounts can have an effect on your...\r\nPosition:13\r\nUrl:https://hbr.org/2021/08/how-to-make-smart-investments-a-beginners-guide\r\nTitle:Making Smart Investments: A Beginner’s Guide - Harvard Business Review\r\nSnippet:Post. Summary. If you make smart decisions and invest in the right places, you can reduce the risk factor, increase the reward factor, and generate meaningful returns. Here are a few questions to ...\r\nPosition:14\r\nUrl:https://money.usnews.com/investing/articles/rules-for-investing-in-your-20s\r\nTitle:7 Rules for Investing in Your 20s | Investing | U.S. News\r\nSnippet:So if you're a 20-something, these seven simple rules for investing in your 20s will get you on your way to investing and preparing for a successful retirement: Avoid high fees. Keep it simple ...\r\nPosition:15\r\nUrl:https://www.cnbc.com/2023/09/01/jim-cramers-guide-to-investing-lessons-for-young-people-.html\r\nTitle:Jim Cramer's guide to investing: Lessons for young people - CNBC\r\nSnippet:CNBC's Jim Cramer said it's never too early to start thinking about investing. Young people, even those just out of college, should be thinking about their monetary future, according to Cramer.\r\nPosition:16\r\nUrl:https://www.thinkadvisor.com/2021/08/25/10-things-advisors-should-do-to-attract-young-and-diy-investors/\r\nTitle:10 Things Advisors Should Do to Attract Young and DIY Investors\r\nSnippet:Check out the gallery above to see 10 key things that advisors should do to try and attract more DIY and young investors, as well to continue being competitive with robo-advisors and other rivals ...\r\nPosition:17\r\nUrl:https://www.investopedia.com/articles/younginvestors/12/best-investments-for-young-people.asp\r\nTitle:The Best Investments for Young Adults - Investopedia\r\nSnippet:Updated January 21, 2022 Reviewed by Ebony Howard Fact checked by Suzanne Kvilhaug Young investors who wish to begin a savings plan face a bewildering array of investment options. There are not...\r\nPosition:18\r\nUrl:https://investor.vanguard.com/investor-resources-education/article/6-tips-for-the-young-investor-in-todays-markets\r\nTitle:6 tips for the young investor in todays markets | Vanguard\r\nSnippet:The company’s match is essentially “free money” toward your future that can help you reach your goals sooner—so why miss out? Then consider: Increasing your contribution percentage with each raise you receive. Aim for 10%–15% of your compensation including any company match.\r\nPosition:19\r\nUrl:https://www.forbes.com/sites/chrissmith1/2020/09/08/10-essential-tips-for-new-angel-investors/\r\nTitle:10 Essential Tips For New Angel Investors - Forbes\r\nSnippet:10 Essential Tips For New Angel Investors Chris Smith Contributor I write about the startup scene in Europe and Israel and the challenges and opportunities for entrepreneurs. Click to save this...\r\nPosition:20\r\nUrl:https://www.stash.com/learn/start-investing-young/\r\nTitle:5 Tips for Young Investors | Stash Learn\r\nSnippet:5 Tips for Young Investors. By Team Stash. Young investors have a huge advantage: Time is on your side. If you’re young, chances are that investing may not be on your radar yet. But young investors have a huge advantage over most people when it comes to building wealth, and that’s time. Maybe you’ve just graduated from college, or rented ...\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"tips and advice for investing in young corporation.\".Kansas City,Missouri Please provide a list of intents.\n ASSISTANT:",
    "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: You are writing a description of what user is trying to find (\"query guideline\") in internet search engine. \nA user typed the query \"大森富士代\" expecting results in language \"ja\".Wakayama,Wakayama\n\n#Bing search results for \"大森富士代\"\nPosition:1\r\nUrl:https://www.career-cc.org/column/column000263.html\r\nTitle:～キャリアコンサルタントとしての現場で日々感じていること ...\r\nSnippet:大森 冨士代（おおもり ふじよ） 1997年 株式会社リクルート入社 人材採用サービスの企画営業職として、中小企業向けの中途採用企画・提案営業を経験。営業チーフ\r\nPosition:2\r\nUrl:https://tabelog.com/tokyo/A1315/A131502/13092924/\r\nTitle:冨士家 - 大森/日本料理 | 食べログ\r\nSnippet:冨士家 (大森/日本料理)の店舗情報は食べログでチェック！ 【個室あり / 分煙】口コミや評価、写真など、ユーザーによるリアルな情報が満載です！地図や料理メニューなどの��\r\nPosition:3\r\nUrl:https://tabelog.com/tokyo/A1315/A131502/13098515/\r\nTitle:名代 富士そば 大森店 - 大森/そば | 食べログ\r\nSnippet:名代 富士そば 大森店 (大森/そば)の店舗情報は食べログでチェック！. 【禁煙】口コミや評価、写真など、ユーザーによるリアルな情報が満載です！. 地図や料理メニューなどの�\r\nPosition:4\r\nUrl:https://www.jorudan.co.jp/norikae/route/%E5%A4%A7%E6%A3%AE%EF%BC%88%E6%9D%B1%E4%BA%AC%EF%BC%89_%E5%AF%8C%E5%A3%AB.html\r\nTitle:大森（東京）から富士の乗換案内 - ジョルダン\r\nSnippet:大森（東京）から富士は「新幹線」でのルートもご案内。始発・終電・復路の検索や、時刻表・運賃・路線図・定期代・18きっぷまで情報多数。運行情報、構内図、出口案内、地図も提供中\r\nPosition:5\r\nUrl:https://www.navitime.co.jp/transfer/searchlist?orvStationName=%E5%A4%A7%E6%A3%AE%EF%BC%88%E6%9D%B1%E4%BA%AC%E9%83%BD%EF%BC%89&orvStationCode=00005641&dnvStationName=%E5%AF%8C%E5%A3%AB&dnvStationCode=00007876\r\nTitle:大森（東京都）から富士までの乗換案内 - NAVITIME\r\nSnippet:大森（東京都）から富士への乗り換え案内です。電車のほかに新幹線、飛行機、バス、フェリーを使用するルートもご案内。IC運賃、定期券料金、時刻表、運行状況、駅周辺の地図も確認でき\r\nPosition:6\r\nUrl:https://retty.me/area/PRE13/ARE19/SUB1902/100000840691/\r\nTitle:名代富士そば 大森店(大森/そば（蕎麦）) - Retty\r\nSnippet:名代富士そば 大森店 なだいふじそば おおもりてん 予算 ～1000円 ～1000円 最寄駅 JR京浜東北線 ／ 大森駅 徒歩2分（110m） ジャンル そば（蕎麦）\r\nPosition:7\r\nUrl:https://www.oomori-fujiya.com/%E5%A4%9C%E3%81%AE%E9%83%A8/\r\nTitle:大森 割烹 鮨 「冨士家」-夜の部- - 大森 割烹・鮨 「冨士家」\r\nSnippet:夜の部 17時～21時30分 おまかせ会席コース 6000円 ～10000円 先附、お椀、造り、焼き物、煮物、揚げ物、お食事、デザート ※おまかせ会席はご予算にてコ\r\nPosition:8\r\nUrl:https://ekitan.com/transit/route/sf-2946/st-1730\r\nTitle:「富士駅」から「大森(東京)駅」乗り換え案内 - 駅探\r\nSnippet:富士駅 から 大森 (東京)駅 までの経路. 検索条件を変更. 2023年11月20日 (月) 21:49出発. 10分前に出発 10分後に出発. 時間順. 料金順. 乗換回数順. 1. 21\r\nPosition:9\r\nUrl:https://www.asahi.com/articles/ASS2445RYS24UTIL008.html\r\nTitle:JR大森駅近くの飲食店で火災、京浜東北線が一時運転見合わせ ...\r\nSnippet:現場はJR大森駅のすぐ近く。東京消防庁によると、20代の男性1人がやけどを負い、女性1人が転倒して頭にけがをし… 4日午前10時過ぎ、東京都大田 ...\r\nPosition:10\r\nUrl:https://www.navitime.co.jp/transfer/pass/result?orvStationCode=00005641&dnvStationCode=00007877\r\nTitle:大森(東京都)から富士フイルム前の定期代 - NAVITIME\r\nSnippet:大森(東京都)から富士フイルム前の定期料金です。通勤、通学（大学生）、通学（高校生）、通学（中学生）の種類別に、1ヶ月、3ヶ月、6ヶ月の各期間の合計金額と区間ごとの詳細な定期券\r\nPosition:11\r\nUrl:https://www.driveplaza.com/dp/SearchTop\r\nTitle:高速料金・ルート検索 | ドラぷら(NEXCO東日本)\r\nSnippet:直接入力、地図・道路名・住所などからICを選択して、高速道路のルートと料金が検索できます。全国の高速道路・サービスエリア情報サイト「ドラぷら」は、NEXCO東日本が運営しています。ドライブ旅\r\nPosition:12\r\nUrl:http://www.tritech.jp/aboutus/\r\nTitle:会社案内 | 株式会社トライ・テック\r\nSnippet:株式会社 トライ・テック. Triangle-Technology Co.,Ltd. 所在地. 〒143-0016 東京都大田区大森北1-1-5 YK-16ビル406 〉MAP. TEL.03-6404-3531 FAX.03-6404-\r\nPosition:13\r\nUrl:https://www.kensetumap.com/company/203340/profile.php\r\nTitle:会社概要｜株式会社トライ・テック - 建設工事会社マップ\r\nSnippet:会社名. 株式会社トライ・テック. 代表者名. 中村 富士代（ナカムラ フジヨ）. 所在地. 〒143-0016. 東京都大田区大森北4-12-22. 他の拠点. 〒143-001\r\nPosition:14\r\nUrl:https://www.jorudan.co.jp/norikae/route/%E5%AF%8C%E5%A3%AB_%E5%A4%A7%E6%A3%AE%EF%BC%88%E6%9D%B1%E4%BA%AC%EF%BC%89.html\r\nTitle:富士から大森（東京）の乗換案内 - ジョルダン\r\nSnippet:富士から大森（東京）は「新幹線」でのルートもご案内。始発・終電・復路の検索や、時刻表・運賃・路線図・定期代・18きっぷまで情報多数。運行情報、構内図、出口案内、地図も提供中\r\nPosition:15\r\nUrl:https://www.career-cc.org/news/news000265.html\r\nTitle:2018年5月号『キャリアコンサルタントとしての現場で日々感じて ...\r\nSnippet:2018.05.01 マンスリーコラム 2018年5月号『キャリアコンサルタントとしての現場で日々感じていること』をアップしました 今月のマンスリーコラムは、大森 冨士代 さんです。 ��\r\nPosition:16\r\nUrl:https://www.navitime.co.jp/transfer/searchlist?orvStationName=%E5%A4%A7%E6%A3%AE%EF%BC%88%E6%9D%B1%E4%BA%AC%E9%83%BD%EF%BC%89&orvStationCode=00005641&dnvStationName=%E5%AF%8C%E5%A3%AB%E5%B1%B1%E9%A7%85%E3%80%94%E5%AF%8C%E5%A3%AB%E5%90%89%E7%94%B0%E3%80%95&dnvStationCode=00082688\r\nTitle:大森（東京都）から富士山駅〔富士吉田〕までの乗換案内 ...\r\nSnippet:大森（東京都）から富士山駅〔富士吉田〕への乗り換え案内です。. 電車のほかに新幹線、飛行機、バス、フェリーを使用するルートもご案内。. IC運賃、定期券料金、時刻表、運行状況、\r\nPosition:17\r\nUrl:https://tabelog.com/tokyo/A1315/A131502/13098515/dtlphotolst/smp2/\r\nTitle:写真 : 名代 富士そば 大森店 - 大森/そば | 食べログ\r\nSnippet:JR大森駅東口から徒歩1分 お店の地図を見る このお店の口コミを教えてください 大森駅前にある富士そばです。お店は東口のバスターミナルに面した好立地にあります。外観は、標準的な富士そ\r\nPosition:18\r\nUrl:https://news.yahoo.co.jp/articles/c9c93193e54acdcbd1373a3812d1f606809cbce4/images/000\r\nTitle:子供に会いに行ったのに…小学校入学前の娘の頭を殴りケガさ ...\r\nSnippet:子供に会いに行ったのに…小学校入学前の娘の頭を殴りケガさせたか 30代の父親を逮捕 静岡 (テレビ静岡NEWS) - Yahoo!ニュース. 富士警察署 ...\r\nPosition:19\r\nUrl:https://www.jorudan.co.jp/norikae/route/%E5%A4%A7%E6%A3%AE%EF%BC%88%E6%9D%B1%E4%BA%AC%EF%BC%89_%E6%96%B0%E5%AF%8C%E5%A3%AB%EF%BC%88%E9%9D%99%E5%B2%A1%EF%BC%89.html\r\nTitle:大森（東京）から新富士（静岡）の乗換案内 - ジョルダン\r\nSnippet:大森（東京）から新富士（静岡）は「新幹線」「バス」でのルートもご案内。始発・終電・復路の検索や、時刻表・運賃・路線図・定期代・18きっぷまで情報多数。運行情報、構内図、出口案内\r\nPosition:20\r\nUrl:https://ekitan.com/transit/route/sf-4270/st-1730\r\nTitle:「新富士(静岡)駅」から「大森(東京)駅」乗り換え案内 - 駅探\r\nSnippet:新富士(静岡)から大森(東京)までの乗換案内。電車を使った経路を比較。時刻、乗換回数、所要時間、運賃・料金を案内。 新横浜駅5番線 JR横浜線 快速 桜木町行き 13\r\n\n\n#Query Guidelines Formatting\nWrite 2-3 mutually exclusive interpretations of this query. Order them by likelihood. \n\nNow, for a search query \"大森富士代\".Wakayama,Wakayama Please provide a list of intents.\n ASSISTANT:",
]

params = args.ModelArgs()



tokenizer = FastTokenizer(params)
inference = FastInference(tokenizer.tokenizer, params)
inference.llm.set_tokenizer(tokenizer.tokenizer)

# model_name = "gradientai/Llama-3-8B-Instruct-262k"
# model_name = "/workspace/model/oaas_models"
# llm = LLM(
#     model_name,
#     max_num_seqs=1,
#     enforce_eager=True,
#     max_model_len=4096,
# )

# Patch MInference Module
# minference_patch = MInference(attn_type="vllm", model_name=model_name, config_path="/workspace/MInference/minference/configs/Mistral_7B_BGM_kv_out_v32_fit_o_best_pattern.json")
# config_path="/workspace/model/oaas_models/config.json"
# llm = minference_patch(llm)


# batch predict
# preprocessed_dict = tokenizer.tokenize(prompts)
# batchsize = len(preprocessed_dict["input_ids"])

# inference.sampling_params = preprocessed_dict["sampling_config"]

# outputs = inference.llm.generate(
#     sampling_params=inference.sampling_params,
#     prompt_token_ids=preprocessed_dict["input_ids"],
#     use_tqdm=True,
# )


# print(f"EOS TOKEN ID:{tokenizer.tokenizer.eos_token_id}")
# for output in outputs :
#     print(f"outputs lens:{len(outputs)}\ntoken_ids:{output.outputs[0].text}\ntoken_ids_lens:{len(output.outputs[0].token_ids)}\n--------------------------\n")
# print(f"0------------------------------------------------------------------------0")



# predict
for prompt in prompts:
    preprocessed_dict = tokenizer.tokenize([prompt])
    batchsize = len(preprocessed_dict["input_ids"])

    inference.sampling_params = preprocessed_dict["sampling_config"]

    inference_start = time.perf_counter()
    outputs = inference.llm.generate(
        sampling_params=inference.sampling_params,
        prompt_token_ids=preprocessed_dict["input_ids"],
        use_tqdm=True,
    )
    inference_latency = (time.perf_counter() - inference_start) * 1000
    


    # print(f"EOS TOKEN ID:{tokenizer.tokenizer.eos_token_id}")
    for output in outputs :
        print(f"outputs lens:{len(outputs)}\ntoken_ids:{output.outputs[0].text}\ntoken_ids_lens:{len(output.outputs[0].token_ids)}\ninference lantency:{inference_latency}\n--------------------------\n")
    print(f"0------------------------------------------------------------------------0")


# Print the outputs.
# for output in outputs:
#     prompt = output.prompt
#     generated_text = output.outputs[0].text
#     print(f"Generated text: {generated_text!r}")
# Prompt: {prompt!r},